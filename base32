#!/usr/bin/python
import hashlib
import sys

def encode(string):

    token= hashlib.sha1(string+'downloads').hexdigest()[0:10]
    num= int(token,16)
    encode=[
            '0','1','2','3','4','5','6','7','8','9',
            'a','b','c','d','e','f','g','h',
            'j','k',
            'm','n',
            'p','q','r','s','t',
            'v','w','x','y','z']
    o=''

    while num > 0:
        v= num & 31
        o= o+encode[v]
        num=num>>5

    encoded= o[:4]+'-'+o[4:]
    return encoded

def decode(string):
    decode={
     '0':  0, '1':  1, '2':  2, '3':  3, '4':  4,
     '5':  5, '6':  6, '7':  7, '8':  8, '9':  9,
     'a': 10, 'b': 11, 'c': 12, 'd': 13, 'e': 14,
     'f': 15, 'g': 16, 'h': 17, 'i':  1, 'j': 18, 
     'k': 19, 'l':  1, 'm': 20, 'n': 21, 'o':  0,
     'p': 22, 'q': 23, 'r': 24, 's': 25, 't': 26, 
     'v': 27, 'w': 28, 'x': 29, 'y': 30, 'z': 31} 

    result=0

    for c in string[::-1]:
        if c=='-':
            continue
        result = result << 5
        result += decode[c.lower()]

    decoded= "{0:x}".format(result).zfill(10)

    return decoded

if sys.argv[1] == '-d':
    print decode(sys.argv[2])
else:
    if sys.argv[1] == '-e': sys.argv.pop(1)
    print encode(sys.argv[1])
